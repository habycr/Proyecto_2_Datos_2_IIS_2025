Estructura del directorio: C:\Users\Javier\OneDrive\Documentos\GitHub\Proyecto_2_Datos_2_IIS_2025

Proyecto_2_Datos_2_IIS_2025
‚îú‚îÄ‚îÄ .gitattributes
‚îú‚îÄ‚îÄ .gitignore
‚îú‚îÄ‚îÄ Analizador
‚îÇ   ‚îú‚îÄ‚îÄ server.cpp
‚îú‚îÄ‚îÄ CMakeLists.txt
‚îú‚îÄ‚îÄ Gestor
‚îÇ   ‚îú‚îÄ‚îÄ 1.txt
‚îÇ   ‚îú‚îÄ‚îÄ CMakeLists.txt
‚îÇ   ‚îú‚îÄ‚îÄ GestorREST.cpp
‚îÇ   ‚îú‚îÄ‚îÄ build
‚îÇ   ‚îú‚îÄ‚îÄ include
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ProblemRepository.h
‚îÇ   ‚îú‚îÄ‚îÄ main_db_test.cpp
‚îÇ   ‚îú‚îÄ‚îÄ src
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ProblemRepository.cpp
‚îÇ   ‚îú‚îÄ‚îÄ test_json
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ p1.json
‚îú‚îÄ‚îÄ LICENSE
‚îú‚îÄ‚îÄ Motor
‚îÇ   ‚îú‚îÄ‚îÄ 2.txt
‚îú‚îÄ‚îÄ ProyectoCompleto.txt
‚îú‚îÄ‚îÄ README.md
‚îú‚îÄ‚îÄ UI
‚îÇ   ‚îú‚îÄ‚îÄ AdminWindow.xaml
‚îÇ   ‚îú‚îÄ‚îÄ AdminWindow.xaml.cs
‚îÇ   ‚îú‚îÄ‚îÄ ApiClient.cs
‚îÇ   ‚îú‚îÄ‚îÄ App.xaml
‚îÇ   ‚îú‚îÄ‚îÄ App.xaml.cs
‚îÇ   ‚îú‚îÄ‚îÄ AssemblyInfo.cs
‚îÇ   ‚îú‚îÄ‚îÄ MainWindow.xaml
‚îÇ   ‚îú‚îÄ‚îÄ MainWindow.xaml.cs
‚îÇ   ‚îú‚îÄ‚îÄ Models
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ProblemDto.cs
‚îÇ   ‚îú‚îÄ‚îÄ Services
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ProblemApiClient.cs
‚îÇ   ‚îú‚îÄ‚îÄ UI.csproj
‚îÇ   ‚îú‚îÄ‚îÄ UI.csproj.user
‚îÇ   ‚îú‚îÄ‚îÄ UI.sln
‚îú‚îÄ‚îÄ main.cpp

================================================================================
CONTENIDO DE ARCHIVOS
================================================================================

Analizador\server.cpp:
----------------------
#include <iostream>
#include <string>
#include <cstring>
#include <sys/socket.h>
#include <netinet/in.h>
#include <unistd.h>


int main(){
    int server_socket = socket(AF_INET, SOCK_STREAM, 0);
    sockaddr_in addr{};
    addr.sin_family = AF_INET;
    addr.sin_addr.s_addr = INADDR_ANY;
    addr.sin_port = htons(8080);

    int opt = 1;
    setsockopt(server_socket, SOL_SOCKET, SO_REUSEADDR, &opt, sizeof(opt));
    bind(server_socket, (sockaddr*)&addr, sizeof(addr));
    listen(server_socket, 10);

    std::cout << "Server listening on port 8080..." << std::endl;
    while (true) {
        int client_socket = accept(server_socket, nullptr, nullptr);
        char buffer[1024];
        memset(buffer, 0, sizeof(buffer));
        read(client_socket, buffer, sizeof(buffer) - 1);
        std::cout << "Received: " << buffer << std::endl;
        const char* response = "HTTP/1.1 200 OK\r\nContent-Length: 13\r\n\r\nHello, World!";
        send(client_socket, response, strlen(response), 0);
        close(client_socket);
    }
    close(server_socket);
    return 0;
}




--------------------------------------------------

CMakeLists.txt:
---------------
# üîß Configura VCPKG como toolchain (antes del project)
if(NOT DEFINED CMAKE_TOOLCHAIN_FILE)
    if(DEFINED ENV{VCPKG_ROOT})
        set(CMAKE_TOOLCHAIN_FILE "$ENV{VCPKG_ROOT}/scripts/buildsystems/vcpkg.cmake"
                CACHE STRING "Vcpkg toolchain")
    else()
        message(WARNING "VCPKG_ROOT no est√° definido. Define la variable de entorno o establece CMAKE_TOOLCHAIN_FILE manualmente.")
    endif()
endif()
cmake_minimum_required(VERSION 3.15)
project(CodeCoachDBTest)

# üß† Est√°ndar de C++
set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)

# üì¶ MongoDB (C++ driver)
find_package(mongocxx CONFIG REQUIRED)
find_package(bsoncxx CONFIG REQUIRED)

# üì¶ Crow (framework HTTP) ‚Äì solo para los includes (es header-only)
find_package(crow CONFIG REQUIRED)

# ============================================================
# Ejecutable 1: Prueba de BD (main_db_test)
# ============================================================
add_executable(CodeCoachDBTest
        Gestor/main_db_test.cpp
        Gestor/src/ProblemRepository.cpp
)

target_include_directories(CodeCoachDBTest
        PRIVATE
        ${CMAKE_CURRENT_SOURCE_DIR}/Gestor/include
)

target_link_libraries(CodeCoachDBTest
        PRIVATE
        mongo::mongocxx_shared
        mongo::bsoncxx_shared
)

# ============================================================
# Ejecutable 2: Servidor REST (problem_manager_api)
# ============================================================
add_executable(problem_manager_api
        Gestor/GestorREST.cpp
        Gestor/src/ProblemRepository.cpp
)

target_include_directories(problem_manager_api
        PRIVATE
        ${CMAKE_CURRENT_SOURCE_DIR}/Gestor/include
)

# üëá SOLO MongoDB; Crow NO se enlaza porque es header-only
target_link_libraries(problem_manager_api
        PRIVATE
        mongo::mongocxx_shared
        mongo::bsoncxx_shared
)

# ============================================================
# NOTA: Si m√°s adelante agregas una UI en C++ con Qt6,
#       ah√≠ s√≠ volvemos a activar AUTOMOC/AUTOUIC y find_package(Qt6)
#       pero por ahora no los necesitamos, porque la UI real es en C#/.NET.
# ============================================================


--------------------------------------------------

Gestor\1.txt:
-------------
chjbcdhjcdvcd

--------------------------------------------------

Gestor\CMakeLists.txt:
----------------------
# Este archivo NO genera ejecutables.
# Solo define la librer√≠a "gestor" para que la ra√≠z pueda usarla.

cmake_minimum_required(VERSION 3.15)

# Crear una librer√≠a con el c√≥digo del gestor
add_library(gestor_lib
        src/ProblemRepository.cpp
)

# Incluir los headers dentro de Gestor/include
target_include_directories(gestor_lib
        PUBLIC
        ${CMAKE_CURRENT_SOURCE_DIR}/include
)

# Enlazar mongo C++ driver a esta librer√≠a
target_link_libraries(gestor_lib
        PUBLIC
        mongo::mongocxx_shared
        mongo::bsoncxx_shared
)


--------------------------------------------------

Gestor\GestorREST.cpp:
----------------------
// Archivo: Gestor/src/GestorREST.cpp
// Servidor REST del Gestor de Problemas (CodeCoach)

#include "ProblemRepository.h"

#include <crow.h>
#include <mongocxx/client.hpp>
#include <mongocxx/instance.hpp>
#include <mongocxx/uri.hpp>

#include <algorithm>
#include <optional>
#include <random>
#include <string>
#include <vector>

// =================== Helpers JSON ===================

// Convierte un Problem a JSON (Crow). Si summary = true, omite description, code_stub y test_cases.
static crow::json::wvalue problem_to_json(const Problem& p, bool summary = false) {
    crow::json::wvalue json;

    json["problem_id"] = p.problem_id;
    json["title"]      = p.title;
    json["difficulty"] = p.difficulty;

    if (!summary) {
        json["description"] = p.description;
        json["code_stub"]   = p.code_stub;

        // tags
        for (std::size_t i = 0; i < p.tags.size(); ++i) {
            json["tags"][i] = p.tags[i];
        }

        // test_cases
        for (std::size_t i = 0; i < p.test_cases.size(); ++i) {
            json["test_cases"][i]["input"]           = p.test_cases[i].input;
            json["test_cases"][i]["expected_output"] = p.test_cases[i].expected_output;
        }
    } else {
        // En modo resumen, igual devolvemos tags porque son √∫tiles para filtrar en UI
        for (std::size_t i = 0; i < p.tags.size(); ++i) {
            json["tags"][i] = p.tags[i];
        }
    }

    return json;
}

// Convierte un JSON (Crow) a Problem.
// - require_id = true en POST: el body debe traer problem_id.
// - require_id = false en PUT: el id viene en la ruta, no en el JSON.
static std::optional<Problem> json_to_problem(const crow::json::rvalue& body,
                                              bool require_id,
                                              std::string& error_out) {
    Problem p;

    using crow::json::type;

    // Helper para validar un campo string
    auto get_string = [&](const char* name, bool required, std::string& dst) -> bool {
        if (!body.has(name)) {
            if (required) {
                error_out = std::string("Falta el campo obligatorio '") + name + "'";
                return false;
            }
            return true; // no requerido
        }
        if (body[name].t() != type::String) {
            error_out = std::string("El campo '") + name + "' debe ser string";
            return false;
        }
        dst = std::string(body[name].s());
        return true;
    };

    if (require_id) {
        if (!get_string("problem_id", true, p.problem_id)) return std::nullopt;
    }

    if (!get_string("title",       true, p.title))       return std::nullopt;
    if (!get_string("description", true, p.description)) return std::nullopt;
    if (!get_string("difficulty",  true, p.difficulty))  return std::nullopt;
    if (!get_string("code_stub",   true, p.code_stub))   return std::nullopt;

    // tags (lista de strings)
    if (!body.has("tags") || body["tags"].t() != type::List) {
        error_out = "El campo 'tags' es obligatorio y debe ser una lista";
        return std::nullopt;
    }
    for (std::size_t i = 0; i < body["tags"].size(); ++i) {
        if (body["tags"][i].t() != type::String) {
            error_out = "Todos los elementos de 'tags' deben ser strings";
            return std::nullopt;
        }
        p.tags.emplace_back(body["tags"][i].s());
    }

    // test_cases (lista de objetos { input, expected_output })
    if (!body.has("test_cases") || body["test_cases"].t() != type::List) {
        error_out = "El campo 'test_cases' es obligatorio y debe ser una lista";
        return std::nullopt;
    }

    for (std::size_t i = 0; i < body["test_cases"].size(); ++i) {
        const auto& tc_json = body["test_cases"][i];

        if (tc_json.t() != type::Object) {
            error_out = "Cada elemento de 'test_cases' debe ser un objeto";
            return std::nullopt;
        }

        if (!tc_json.has("input") ||
            tc_json["input"].t() != type::String ||
            !tc_json.has("expected_output") ||
            tc_json["expected_output"].t() != type::String) {
            error_out = "Cada test_case debe tener 'input' y 'expected_output' como strings";
            return std::nullopt;
        }

        TestCase tc;
        tc.input           = std::string(tc_json["input"].s());
        tc.expected_output = std::string(tc_json["expected_output"].s());
        p.test_cases.push_back(std::move(tc));
    }

    return p;
}

// Crea una respuesta HTTP con JSON y c√≥digo de estado
static crow::response make_json_response(int status, const crow::json::wvalue& body) {
    crow::response res;
    res.code = status;
    res.set_header("Content-Type", "application/json");
    res.body = body.dump();
    return res;
}

// Crea una respuesta de error JSON simple
static crow::response make_error_response(int status, const std::string& message) {
    crow::json::wvalue body;
    body["error"] = message;
    return make_json_response(status, body);
}

// =================== main ===================

int main() {
    try {
        // 1. Inicializar MongoDB driver
        mongocxx::instance inst{}; // una sola vez por proceso

        // 2. Conectarse a MongoDB local
        mongocxx::client client{mongocxx::uri{"mongodb://localhost:27017"}};
        auto db = client["codecoach"];

        // 3. Crear el repositorio de problemas
        ProblemRepository repo{db};

        // 4. Inicializar la app Crow
        crow::SimpleApp app;

        // --------- Endpoint de salud ---------
        CROW_ROUTE(app, "/health")
        ([] {
            crow::json::wvalue body;
            body["status"] = "OK";
            return make_json_response(200, body);
        });

        // --------- GET /problems (lista resumida) ---------
        CROW_ROUTE(app, "/problems")
        ([&repo](const crow::request&) {
            auto problems = repo.get_all();

            crow::json::wvalue body;
            for (std::size_t i = 0; i < problems.size(); ++i) {
                body["problems"][i] = problem_to_json(problems[i], /*summary=*/true);
            }

            return make_json_response(200, body);
        });

        // --------- GET /problems/<id> (detalle completo) ---------
        CROW_ROUTE(app, "/problems/<string>")
        ([&repo](const crow::request&, const std::string& problem_id) {
            auto maybe = repo.get_by_id(problem_id);
            if (!maybe) {
                return make_error_response(404, "Problema no encontrado");
            }

            crow::json::wvalue body = problem_to_json(*maybe, /*summary=*/false);
            return make_json_response(200, body);
        });

        // --------- GET /problems/difficulty/<level> ---------
        CROW_ROUTE(app, "/problems/difficulty/<string>")
        ([&repo](const crow::request&, const std::string& level) {
            auto problems = repo.get_by_difficulty(level);

            crow::json::wvalue body;
            for (std::size_t i = 0; i < problems.size(); ++i) {
                body["problems"][i] = problem_to_json(problems[i], /*summary=*/true);
            }

            return make_json_response(200, body);
        });

        // --------- GET /problems/tags/<tag> (filtra en memoria) ---------
        CROW_ROUTE(app, "/problems/tags/<string>")
        ([&repo](const crow::request&, const std::string& tag) {
            auto all = repo.get_all();
            std::vector<Problem> filtered;

            for (const auto& p : all) {
                if (std::find(p.tags.begin(), p.tags.end(), tag) != p.tags.end()) {
                    filtered.push_back(p);
                }
            }

            crow::json::wvalue body;
            for (std::size_t i = 0; i < filtered.size(); ++i) {
                body["problems"][i] = problem_to_json(filtered[i], /*summary=*/true);
            }

            return make_json_response(200, body);
        });

        // --------- GET /problems/random ---------
        CROW_ROUTE(app, "/problems/random")
        ([&repo](const crow::request&) {
            auto all = repo.get_all();
            if (all.empty()) {
                return make_error_response(404, "No hay problemas en la base de datos");
            }

            std::random_device rd;
            std::mt19937 gen(rd());
            std::uniform_int_distribution<std::size_t> dist(0, all.size() - 1);

            const auto& chosen = all[dist(gen)];
            crow::json::wvalue body = problem_to_json(chosen, /*summary=*/false);
            return make_json_response(200, body);
        });

        // --------- POST /problems (crear) ---------
        CROW_ROUTE(app, "/problems").methods(crow::HTTPMethod::Post)
        ([&repo](const crow::request& req) {
            auto body_json = crow::json::load(req.body);
            if (!body_json) {
                return make_error_response(400, "JSON malformado");
            }

            std::string error;
            auto maybe_problem = json_to_problem(body_json, /*require_id=*/true, error);
            if (!maybe_problem) {
                return make_error_response(400, error);
            }

            Problem p = *maybe_problem;

            // Verificar si ya existe ese problem_id
            auto existing = repo.get_by_id(p.problem_id);
            if (existing) {
                return make_error_response(400, "Ya existe un problema con ese problem_id");
            }

            repo.insert_problem(p);

            crow::json::wvalue res_body;
            res_body["message"]    = "Problema creado correctamente";
            res_body["problem_id"] = p.problem_id;
            return make_json_response(201, res_body);
        });

        // --------- PUT /problems/<id> (actualizar) ---------
        CROW_ROUTE(app, "/problems/<string>").methods(crow::HTTPMethod::Put)
        ([&repo](const crow::request& req, const std::string& problem_id) {
            auto body_json = crow::json::load(req.body);
            if (!body_json) {
                return make_error_response(400, "JSON malformado");
            }

            std::string error;
            // No requerimos problem_id en el body; viene en la URL
            auto maybe_problem = json_to_problem(body_json, /*require_id=*/false, error);
            if (!maybe_problem) {
                return make_error_response(400, error);
            }

            Problem p = *maybe_problem;
            p.problem_id = problem_id; // clave l√≥gica desde la URL

            // Intentamos actualizar
            bool updated = repo.update_problem(p);
            if (!updated) {
                return make_error_response(404, "No se encontr√≥ un problema con ese problem_id para actualizar");
            }

            crow::json::wvalue res_body;
            res_body["message"]    = "Problema actualizado correctamente";
            res_body["problem_id"] = p.problem_id;
            return make_json_response(200, res_body);
        });

        // --------- DELETE /problems/<id> (eliminar) ---------
        CROW_ROUTE(app, "/problems/<string>").methods(crow::HTTPMethod::Delete)
        ([&repo](const crow::request&, const std::string& problem_id) {
            bool deleted = repo.delete_problem(problem_id);
            if (!deleted) {
                return make_error_response(404, "No se encontr√≥ un problema con ese problem_id para eliminar");
            }

            crow::json::wvalue res_body;
            res_body["message"]    = "Problema eliminado correctamente";
            res_body["problem_id"] = problem_id;
            return make_json_response(200, res_body);
        });

        // 5. Levantar el servidor
        std::cout << "[GestorREST] Escuchando en http://localhost:8080 ..." << std::endl;
        app.port(8080).multithreaded().run();
    }
    catch (const std::exception& ex) {
        std::cerr << "[GestorREST] Excepci√≥n fatal: " << ex.what() << std::endl;
        return 1;
    }
    catch (...) {
        std::cerr << "[GestorREST] Excepci√≥n desconocida" << std::endl;
        return 1;
    }

    return 0;
}


--------------------------------------------------

Gestor\include\ProblemRepository.h:
-----------------------------------
#pragma once

#include <mongocxx/database.hpp>
#include <mongocxx/collection.hpp>

#include <string>
#include <vector>
#include <optional>

// Representa un caso de prueba de un problema
struct TestCase {
    std::string input;
    std::string expected_output;
};

// Representa un problema de CodeCoach
struct Problem {
    std::string problem_id;           // ID legible (ej: "sum-two-numbers")
    std::string title;
    std::string description;
    std::string difficulty;           // "F√°cil", "Medio", "Dif√≠cil"
    std::vector<std::string> tags;    // ["intro", "math"]
    std::vector<TestCase> test_cases; // Casos de prueba
    std::string code_stub;            // C√≥digo base opcional
};

// Repositorio que encapsula el acceso a MongoDB
class ProblemRepository {
public:
    explicit ProblemRepository(mongocxx::database db);

    // Crea un nuevo documento en la colecci√≥n "problems"
    void insert_problem(const Problem& p);

    // Devuelve todos los problemas
    std::vector<Problem> get_all();

    // Busca por problem_id (clave l√≥gica)
    std::optional<Problem> get_by_id(const std::string& id);

    // Lista problemas filtrados por dificultad
    std::vector<Problem> get_by_difficulty(const std::string& difficulty);

    // Actualiza un problema existente (match por problem_id)
    bool update_problem(const Problem& p);

    // Elimina un problema (match por problem_id)
    bool delete_problem(const std::string& id);

private:
    mongocxx::collection collection_;
};


--------------------------------------------------

Gestor\main_db_test.cpp:
------------------------
#include <mongocxx/instance.hpp>
#include <mongocxx/client.hpp>
#include <mongocxx/uri.hpp>
#include <iostream>

#include "ProblemRepository.h"

int main() {
    try {
        mongocxx::instance inst{};  // Inicializa driver MongoDB (una sola vez)
        mongocxx::client client{mongocxx::uri{"mongodb://localhost:27017"}};

        auto db = client["codecoach"];  // Nombre de tu base de datos
        ProblemRepository repo{db};

        // Crear problema de ejemplo
        Problem p;
        p.problem_id  = "sum-two-numbers";
        p.title       = "Suma de dos n√∫meros";
        p.description = "Dado dos enteros a y b, imprima su suma.";
        p.difficulty  = "F√°cil";
        p.code_stub   = "int solve(int a, int b) { return a + b; }";
        p.tags        = {"intro", "math"};
        p.test_cases = {
            {"2 3", "5"},
            {"10 20", "30"}
        };

        repo.insert_problem(p);
        std::cout << "[OK] Problema insertado.\n";

        auto all = repo.get_all();
        std::cout << "[INFO] Problemas en BD: " << all.size() << "\n";

        auto found = repo.get_by_id("sum-two-numbers");
        if (found) {
            std::cout << "[OK] Encontrado: " << found->title
                      << " (" << found->difficulty << ")\n";
        } else {
            std::cout << "[WARN] No se encontr√≥ sum-two-numbers\n";
        }

    } catch (const std::exception& e) {
        std::cerr << "[ERROR] Excepci√≥n: " << e.what() << "\n";
        return 1;
    }

    return 0;
}


--------------------------------------------------

Gestor\src\ProblemRepository.cpp:
---------------------------------
#include "ProblemRepository.h"

#include <bsoncxx/builder/basic/document.hpp>
#include <bsoncxx/builder/basic/array.hpp>
#include <bsoncxx/json.hpp>
#include <bsoncxx/types.hpp>

using bsoncxx::builder::basic::kvp;
using bsoncxx::builder::basic::document;
using bsoncxx::builder::basic::array;

// =================== Helpers internos ===================

// Convierte un campo string BSON a std::string usando get_string() y k_string
static std::string get_string_field(const bsoncxx::document::view& doc,
                                    const char* field_name) {
    auto elem = doc[field_name];
    if (elem && elem.type() == bsoncxx::type::k_string) {
        auto sv = elem.get_string().value;           // string_view
        return std::string(sv.data(), sv.size());    // lo convertimos a std::string
    }
    return {};
}

// Convierte un documento BSON a un struct Problem
static Problem document_to_problem(const bsoncxx::document::view& doc_view) {
    Problem p;

    // Campos simples
    p.problem_id  = get_string_field(doc_view, "problem_id");
    p.title       = get_string_field(doc_view, "title");
    p.description = get_string_field(doc_view, "description");
    p.difficulty  = get_string_field(doc_view, "difficulty");
    p.code_stub   = get_string_field(doc_view, "code_stub");

    // tags: arreglo de strings
    auto it_tags = doc_view.find("tags");
    if (it_tags != doc_view.end() && it_tags->type() == bsoncxx::type::k_array) {
        auto arr = it_tags->get_array().value;
        for (auto&& t : arr) {
            if (t.type() == bsoncxx::type::k_string) {
                auto sv = t.get_string().value;
                p.tags.emplace_back(sv.data(), sv.size());
            }
        }
    }

    // test_cases: arreglo de documentos { input, expected_output }
    auto it_tcs = doc_view.find("test_cases");
    if (it_tcs != doc_view.end() && it_tcs->type() == bsoncxx::type::k_array) {
        auto arr = it_tcs->get_array().value;
        for (auto&& tc_elem : arr) {
            if (tc_elem.type() == bsoncxx::type::k_document) {
                auto tc_doc = tc_elem.get_document().value;
                TestCase tc;

                auto it_in = tc_doc.find("input");
                if (it_in != tc_doc.end() && it_in->type() == bsoncxx::type::k_string) {
                    auto sv = it_in->get_string().value;
                    tc.input.assign(sv.data(), sv.size());
                }

                auto it_out = tc_doc.find("expected_output");
                if (it_out != tc_doc.end() && it_out->type() == bsoncxx::type::k_string) {
                    auto sv = it_out->get_string().value;
                    tc.expected_output.assign(sv.data(), sv.size());
                }

                p.test_cases.push_back(std::move(tc));
            }
        }
    }

    return p;
}

// =================== Implementaci√≥n de ProblemRepository ===================

ProblemRepository::ProblemRepository(mongocxx::database db)
    : collection_{db["problems"]} {}

// INSERT
void ProblemRepository::insert_problem(const Problem& p) {
    // Construir arreglo de tags
    array tags_arr;
    for (const auto& t : p.tags) {
        tags_arr.append(t);
    }

    // Construir arreglo de test_cases
    array tcs_arr;
    for (const auto& tc : p.test_cases) {
        document tc_doc;
        tc_doc.append(
            kvp("input", tc.input),
            kvp("expected_output", tc.expected_output)
        );
        tcs_arr.append(tc_doc.extract());
    }

    document doc_builder;
    doc_builder.append(
        kvp("problem_id", p.problem_id),
        kvp("title", p.title),
        kvp("description", p.description),
        kvp("difficulty", p.difficulty),
        kvp("code_stub", p.code_stub),
        kvp("tags", tags_arr),
        kvp("test_cases", tcs_arr)
    );

    collection_.insert_one(doc_builder.view());
}

// GET ALL
std::vector<Problem> ProblemRepository::get_all() {
    std::vector<Problem> results;
    auto cursor = collection_.find({});
    for (auto&& doc : cursor) {
        results.push_back(document_to_problem(doc));
    }
    return results;
}

// GET BY ID (problem_id)
std::optional<Problem> ProblemRepository::get_by_id(const std::string& id) {
    auto filter_doc = document{};
    filter_doc.append(kvp("problem_id", id));

    auto maybe_doc = collection_.find_one(filter_doc.view());
    if (!maybe_doc) {
        return std::nullopt;
    }

    return document_to_problem(maybe_doc->view());
}

// GET BY DIFFICULTY
std::vector<Problem> ProblemRepository::get_by_difficulty(const std::string& difficulty) {
    std::vector<Problem> results;

    document filter_doc;
    filter_doc.append(kvp("difficulty", difficulty));

    auto cursor = collection_.find(filter_doc.view());
    for (auto&& doc : cursor) {
        results.push_back(document_to_problem(doc));
    }

    return results;
}

// UPDATE (por problem_id)
bool ProblemRepository::update_problem(const Problem& p) {
    // tags
    array tags_arr;
    for (const auto& t : p.tags) {
        tags_arr.append(t);
    }

    // test_cases
    array tcs_arr;
    for (const auto& tc : p.test_cases) {
        document tc_doc;
        tc_doc.append(
            kvp("input", tc.input),
            kvp("expected_output", tc.expected_output)
        );
        tcs_arr.append(tc_doc.extract());
    }

    // Documento con los campos a actualizar
    document set_doc;
    set_doc.append(
        kvp("title", p.title),
        kvp("description", p.description),
        kvp("difficulty", p.difficulty),
        kvp("code_stub", p.code_stub),
        kvp("tags", tags_arr),
        kvp("test_cases", tcs_arr)
    );

    // Filtro por problem_id
    document filter_doc;
    filter_doc.append(kvp("problem_id", p.problem_id));

    document update_doc;
    update_doc.append(kvp("$set", set_doc.view()));

    auto result = collection_.update_one(filter_doc.view(), update_doc.view());
    return result && result->modified_count() > 0;
}

// DELETE (por problem_id)
bool ProblemRepository::delete_problem(const std::string& id) {
    document filter_doc;
    filter_doc.append(kvp("problem_id", id));

    auto result = collection_.delete_one(filter_doc.view());
    return result && result->deleted_count() > 0;
}


--------------------------------------------------

Motor\2.txt:
------------
nkjb cdhk dskhdv

--------------------------------------------------

README.md:
----------
# Proyecto_2_Datos_2_IIS_2025



--------------------------------------------------

UI\AdminWindow.xaml:
--------------------
Ôªø<!-- Archivo: AdminWindow.xaml -->
<Window x:Class="UI.AdminWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="CodeCoach - Administraci√≥n de Problemas" 
        Height="800" Width="1200"
        WindowStartupLocation="CenterScreen"
        Background="#1e1e1e">

    <Grid Margin="10">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="300"/>
            <ColumnDefinition Width="10"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <!-- ========== PANEL IZQUIERDO: Lista de Problemas ========== -->
        <Border Grid.Column="0" 
                BorderBrush="#3c3c3c" 
                BorderThickness="1" 
                CornerRadius="5"
                Background="#252526">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <!-- T√≠tulo del panel -->
                <TextBlock Grid.Row="0" 
                           Text="üìö Problemas Existentes" 
                           FontSize="16" 
                           FontWeight="Bold"
                           Foreground="White"
                           Padding="10"
                           Background="#2d2d30"/>

                <!-- Lista de problemas -->
                <ListBox x:Name="ProblemListBox" 
                         Grid.Row="1"
                         Background="Transparent"
                         Foreground="White"
                         BorderThickness="0"
                         Margin="5"
                         SelectionChanged="ProblemListBox_SelectionChanged"
                         DisplayMemberPath="title"/>

                <!-- Botones de acci√≥n -->
                <StackPanel Grid.Row="2" 
                            Orientation="Vertical" 
                            Margin="5">
                    <Button x:Name="RefreshButton" 
                            Content="üîÑ Recargar Lista"
                            Click="RefreshButton_Click"
                            Padding="10,8"
                            Margin="0,0,0,5"
                            Background="#0e639c"
                            Foreground="White"
                            BorderThickness="0"
                            Cursor="Hand"/>

                    <Button x:Name="NewButton" 
                            Content="‚ûï Nuevo Problema"
                            Click="NewButton_Click"
                            Padding="10,8"
                            Margin="0,0,0,5"
                            Background="#0e7a0d"
                            Foreground="White"
                            BorderThickness="0"
                            Cursor="Hand"/>

                    <Button x:Name="DeleteButton" 
                            Content="üóëÔ∏è Eliminar Seleccionado"
                            Click="DeleteButton_Click"
                            Padding="10,8"
                            Background="#a80000"
                            Foreground="White"
                            BorderThickness="0"
                            Cursor="Hand"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- Separador -->
        <GridSplitter Grid.Column="1" 
                      Width="10" 
                      HorizontalAlignment="Stretch" 
                      Background="Transparent"/>

        <!-- ========== PANEL DERECHO: Formulario de Edici√≥n ========== -->
        <Border Grid.Column="2" 
                BorderBrush="#3c3c3c" 
                BorderThickness="1" 
                CornerRadius="5"
                Background="#252526">
            <ScrollViewer VerticalScrollBarVisibility="Auto">
                <StackPanel Margin="15">

                    <!-- T√≠tulo del formulario -->
                    <TextBlock x:Name="FormTitle"
                               Text="üìù Detalles del Problema" 
                               FontSize="18" 
                               FontWeight="Bold"
                               Foreground="White"
                               Margin="0,0,0,20"/>

                    <!-- Problem ID -->
                    <TextBlock Text="Problem ID (identificador √∫nico):" 
                               Foreground="White" 
                               Margin="0,0,0,5"/>
                    <TextBox x:Name="ProblemIdTextBox"
                             Padding="8"
                             Background="#3c3c3c"
                             Foreground="White"
                             BorderBrush="#555"
                             Margin="0,0,0,15"/>

                    <!-- T√≠tulo -->
                    <TextBlock Text="T√≠tulo:" 
                               Foreground="White" 
                               Margin="0,0,0,5"/>
                    <TextBox x:Name="TitleTextBox"
                             Padding="8"
                             Background="#3c3c3c"
                             Foreground="White"
                             BorderBrush="#555"
                             Margin="0,0,0,15"/>

                    <!-- Descripci√≥n -->
                    <TextBlock Text="Descripci√≥n:" 
                               Foreground="White" 
                               Margin="0,0,0,5"/>
                    <TextBox x:Name="DescriptionTextBox"
                             Height="120"
                             TextWrapping="Wrap"
                             AcceptsReturn="True"
                             VerticalScrollBarVisibility="Auto"
                             Padding="8"
                             Background="#3c3c3c"
                             Foreground="White"
                             BorderBrush="#555"
                             Margin="0,0,0,15"/>

                    <!-- Dificultad -->
                    <TextBlock Text="Dificultad:" 
                               Foreground="White" 
                               Margin="0,0,0,5"/>
                    <ComboBox x:Name="DifficultyComboBox"
                              Padding="8"
                              Background="#3c3c3c"
                              Foreground="White"
                              BorderBrush="#555"
                              Margin="0,0,0,15">
                        <ComboBoxItem Content="F√°cil"/>
                        <ComboBoxItem Content="Medio"/>
                        <ComboBoxItem Content="Dif√≠cil"/>
                    </ComboBox>

                    <!-- Tags -->
                    <TextBlock Text="Tags (separados por comas):" 
                               Foreground="White" 
                               Margin="0,0,0,5"/>
                    <TextBox x:Name="TagsTextBox"
                             Padding="8"
                             Background="#3c3c3c"
                             Foreground="White"
                             BorderBrush="#555"
                             Margin="0,0,0,15"
                             ToolTip="Ejemplo: intro, math, arrays"/>

                    <!-- Code Stub -->
                    <TextBlock Text="Code Stub (c√≥digo inicial):" 
                               Foreground="White" 
                               Margin="0,0,0,5"/>
                    <TextBox x:Name="CodeStubTextBox"
                             Height="100"
                             TextWrapping="Wrap"
                             AcceptsReturn="True"
                             VerticalScrollBarVisibility="Auto"
                             FontFamily="Consolas"
                             Padding="8"
                             Background="#3c3c3c"
                             Foreground="White"
                             BorderBrush="#555"
                             Margin="0,0,0,20"/>

                    <!-- ===== Secci√≥n Test Cases ===== -->
                    <Border BorderBrush="#555" 
                            BorderThickness="1" 
                            Padding="10" 
                            Background="#2d2d30"
                            Margin="0,0,0,20">
                        <StackPanel>
                            <TextBlock Text="üß™ Casos de Prueba" 
                                       FontSize="14" 
                                       FontWeight="Bold"
                                       Foreground="White" 
                                       Margin="0,0,0,10"/>

                            <!-- Lista de test cases existentes -->
                            <ListBox x:Name="TestCasesListBox"
                                     Height="120"
                                     Background="#1e1e1e"
                                     Foreground="White"
                                     BorderBrush="#555"
                                     Margin="0,0,0,10"/>

                            <!-- Inputs para agregar test case -->
                            <Grid Margin="0,10,0,0">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="10"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>

                                <StackPanel Grid.Column="0">
                                    <TextBlock Text="Input:" 
                                               Foreground="White" 
                                               Margin="0,0,0,5"/>
                                    <TextBox x:Name="TestInputTextBox"
                                             Padding="8"
                                             Background="#3c3c3c"
                                             Foreground="White"
                                             BorderBrush="#555"/>
                                </StackPanel>

                                <StackPanel Grid.Column="2">
                                    <TextBlock Text="Expected Output:" 
                                               Foreground="White" 
                                               Margin="0,0,0,5"/>
                                    <TextBox x:Name="TestOutputTextBox"
                                             Padding="8"
                                             Background="#3c3c3c"
                                             Foreground="White"
                                             BorderBrush="#555"/>
                                </StackPanel>
                            </Grid>

                            <!-- Botones de test cases -->
                            <StackPanel Orientation="Horizontal" 
                                        Margin="0,10,0,0">
                                <Button x:Name="AddTestCaseButton"
                                        Content="‚ûï Agregar Caso"
                                        Click="AddTestCaseButton_Click"
                                        Padding="10,6"
                                        Margin="0,0,10,0"
                                        Background="#0e7a0d"
                                        Foreground="White"
                                        BorderThickness="0"
                                        Cursor="Hand"/>

                                <Button x:Name="RemoveTestCaseButton"
                                        Content="‚ùå Eliminar Seleccionado"
                                        Click="RemoveTestCaseButton_Click"
                                        Padding="10,6"
                                        Background="#a80000"
                                        Foreground="White"
                                        BorderThickness="0"
                                        Cursor="Hand"/>
                            </StackPanel>
                        </StackPanel>
                    </Border>

                    <!-- Bot√≥n Guardar (grande y destacado) -->
                    <Button x:Name="SaveButton"
                            Content="üíæ GUARDAR PROBLEMA"
                            Click="SaveButton_Click"
                            FontSize="16"
                            FontWeight="Bold"
                            Padding="15,12"
                            Background="#0e639c"
                            Foreground="White"
                            BorderThickness="0"
                            Cursor="Hand"
                            HorizontalAlignment="Stretch"/>

                    <!-- Consola de mensajes -->
                    <Border BorderBrush="#555" 
                            BorderThickness="1" 
                            Background="#1e1e1e" 
                            Margin="0,20,0,0"
                            Padding="10">
                        <TextBox x:Name="ConsoleTextBox"
                                 Height="150"
                                 IsReadOnly="True"
                                 TextWrapping="Wrap"
                                 VerticalScrollBarVisibility="Auto"
                                 Background="Transparent"
                                 Foreground="#00ff00"
                                 BorderThickness="0"
                                 FontFamily="Consolas"
                                 FontSize="12"/>
                    </Border>

                </StackPanel>
            </ScrollViewer>
        </Border>
    </Grid>
</Window>

--------------------------------------------------

UI\AdminWindow.xaml.cs:
-----------------------
Ôªø// Archivo: AdminWindow.xaml.cs

using System;
using System.Collections.Generic;
using System.Linq;
using System.Windows;
using System.Windows.Controls;
using UI.Models;
using UI.Services;

namespace UI
{
    public partial class AdminWindow : Window
    {
        private ProblemApiClient _apiClient;
        private ProblemDto? _selectedProblem; // El problema que est√° siendo editado
        private List<TestCaseDto> _currentTestCases; // Test cases temporales (antes de guardar)

        public AdminWindow()
        {
            InitializeComponent();

            // Inicializar cliente API
            _apiClient = new ProblemApiClient("http://localhost:8080");
            _currentTestCases = new List<TestCaseDto>();

            // Cargar lista al iniciar
            Loaded += AdminWindow_Loaded;
        }

        // ==================== Inicializaci√≥n ====================
        private async void AdminWindow_Loaded(object sender, RoutedEventArgs e)
        {
            await LoadProblemsAsync();
            ClearForm(); // Formulario vac√≠o al inicio
        }

        // ==================== Cargar lista de problemas ====================
        private async System.Threading.Tasks.Task LoadProblemsAsync()
        {
            try
            {
                Log("üîÑ Cargando lista de problemas...");

                bool isHealthy = await _apiClient.IsHealthyAsync();
                if (!isHealthy)
                {
                    Log("‚ùå ERROR: No se puede conectar al Gestor (http://localhost:8080)");
                    Log("   Aseg√∫rate de que problem_manager_api.exe est√© corriendo.");
                    return;
                }

                var problems = await _apiClient.GetAllProblemsAsync();

                ProblemListBox.ItemsSource = problems;

                Log($"‚úÖ {problems.Count} problema(s) cargado(s).");
            }
            catch (Exception ex)
            {
                Log($"‚ùå ERROR al cargar problemas: {ex.Message}");
            }
        }

        // ==================== Problema seleccionado de la lista ====================
        private async void ProblemListBox_SelectionChanged(object sender, SelectionChangedEventArgs e)
        {
            if (ProblemListBox.SelectedItem is not ProblemDto selectedProblem)
                return;

            try
            {
                Log($"üì• Cargando detalles de '{selectedProblem.title}'...");

                // Obtener el problema completo
                var fullProblem = await _apiClient.GetProblemAsync(selectedProblem.problem_id);

                if (fullProblem == null)
                {
                    Log("‚ùå ERROR: No se pudo cargar el problema completo.");
                    return;
                }

                _selectedProblem = fullProblem;
                LoadProblemToForm(fullProblem);

                Log($"‚úÖ Problema cargado. Puedes editarlo y presionar 'Guardar'.");
            }
            catch (Exception ex)
            {
                Log($"‚ùå ERROR: {ex.Message}");
            }
        }

        // ==================== Mapear ProblemDto ‚Üí Formulario ====================
        private void LoadProblemToForm(ProblemDto problem)
        {
            FormTitle.Text = $"üìù Editando: {problem.title}";

            ProblemIdTextBox.Text = problem.problem_id;
            ProblemIdTextBox.IsEnabled = false; // No se puede cambiar el ID en edici√≥n

            TitleTextBox.Text = problem.title;
            DescriptionTextBox.Text = problem.description;
            CodeStubTextBox.Text = problem.code_stub;

            // Dificultad
            DifficultyComboBox.SelectedIndex = problem.difficulty switch
            {
                "F√°cil" => 0,
                "Medio" => 1,
                "Dif√≠cil" => 2,
                _ => 0
            };

            // Tags
            TagsTextBox.Text = string.Join(", ", problem.tags);

            // Test cases
            _currentTestCases = new List<TestCaseDto>(problem.test_cases);
            RefreshTestCasesList();
        }

        // ==================== Mapear Formulario ‚Üí ProblemDto ====================
        private ProblemDto? FormToProblemDto()
        {
            try
            {
                // Validaciones b√°sicas
                if (string.IsNullOrWhiteSpace(ProblemIdTextBox.Text))
                {
                    Log("‚ùå ERROR: El Problem ID no puede estar vac√≠o.");
                    return null;
                }

                if (string.IsNullOrWhiteSpace(TitleTextBox.Text))
                {
                    Log("‚ùå ERROR: El t√≠tulo no puede estar vac√≠o.");
                    return null;
                }

                if (DifficultyComboBox.SelectedItem == null)
                {
                    Log("‚ùå ERROR: Debes seleccionar una dificultad.");
                    return null;
                }

                if (_currentTestCases.Count == 0)
                {
                    Log("‚ö†Ô∏è ADVERTENCIA: No hay casos de prueba. El problema se crear√° sin tests.");
                }

                // Crear el DTO
                var problem = new ProblemDto
                {
                    problem_id = ProblemIdTextBox.Text.Trim(),
                    title = TitleTextBox.Text.Trim(),
                    description = DescriptionTextBox.Text.Trim(),
                    difficulty = (DifficultyComboBox.SelectedItem as ComboBoxItem)?.Content.ToString() ?? "F√°cil",
                    code_stub = CodeStubTextBox.Text.Trim(),
                    tags = TagsTextBox.Text
                        .Split(new[] { ',' }, StringSplitOptions.RemoveEmptyEntries)
                        .Select(t => t.Trim())
                        .ToList(),
                    test_cases = new List<TestCaseDto>(_currentTestCases)
                };

                return problem;
            }
            catch (Exception ex)
            {
                Log($"‚ùå ERROR al procesar el formulario: {ex.Message}");
                return null;
            }
        }

        // ==================== Bot√≥n: Nuevo Problema ====================
        private void NewButton_Click(object sender, RoutedEventArgs e)
        {
            ClearForm();
            Log("üìù Formulario limpio. Completa los campos para crear un nuevo problema.");
        }

        // ==================== Bot√≥n: Guardar (POST o PUT) ====================
        private async void SaveButton_Click(object sender, RoutedEventArgs e)
        {
            var problem = FormToProblemDto();
            if (problem == null)
                return; // Ya se mostr√≥ el error en FormToProblemDto

            try
            {
                bool success;

                // ¬øEs un problema nuevo o estamos editando?
                if (_selectedProblem == null ||
                    _selectedProblem.problem_id != problem.problem_id)
                {
                    // POST: Crear nuevo problema
                    Log($"üíæ Creando problema '{problem.problem_id}'...");
                    success = await _apiClient.CreateProblemAsync(problem);

                    if (success)
                    {
                        Log($"‚úÖ Problema '{problem.problem_id}' creado exitosamente.");
                        await LoadProblemsAsync();
                        ClearForm();
                    }
                    else
                    {
                        Log($"‚ùå ERROR: No se pudo crear el problema.");
                        Log("   Verifica que el problem_id no exista ya en la base de datos.");
                    }
                }
                else
                {
                    // PUT: Actualizar problema existente
                    Log($"üíæ Actualizando problema '{problem.problem_id}'...");
                    success = await _apiClient.UpdateProblemAsync(problem.problem_id, problem);

                    if (success)
                    {
                        Log($"‚úÖ Problema '{problem.problem_id}' actualizado exitosamente.");
                        await LoadProblemsAsync();
                    }
                    else
                    {
                        Log($"‚ùå ERROR: No se pudo actualizar el problema.");
                    }
                }
            }
            catch (Exception ex)
            {
                Log($"‚ùå ERROR al guardar: {ex.Message}");
            }
        }

        // ==================== Bot√≥n: Eliminar ====================
        private async void DeleteButton_Click(object sender, RoutedEventArgs e)
        {
            if (ProblemListBox.SelectedItem is not ProblemDto selectedProblem)
            {
                Log("‚ùå ERROR: Selecciona un problema de la lista primero.");
                return;
            }

            // Confirmaci√≥n
            var result = MessageBox.Show(
                $"¬øEst√°s seguro de eliminar el problema '{selectedProblem.title}'?\n\n" +
                $"Esta acci√≥n NO se puede deshacer.",
                "Confirmar Eliminaci√≥n",
                MessageBoxButton.YesNo,
                MessageBoxImage.Warning
            );

            if (result != MessageBoxResult.Yes)
                return;

            try
            {
                Log($"üóëÔ∏è Eliminando '{selectedProblem.problem_id}'...");

                bool success = await _apiClient.DeleteProblemAsync(selectedProblem.problem_id);

                if (success)
                {
                    Log($"‚úÖ Problema '{selectedProblem.problem_id}' eliminado exitosamente.");
                    await LoadProblemsAsync();
                    ClearForm();
                }
                else
                {
                    Log($"‚ùå ERROR: No se pudo eliminar el problema.");
                }
            }
            catch (Exception ex)
            {
                Log($"‚ùå ERROR al eliminar: {ex.Message}");
            }
        }

        // ==================== Bot√≥n: Recargar Lista ====================
        private async void RefreshButton_Click(object sender, RoutedEventArgs e)
        {
            await LoadProblemsAsync();
        }

        // ==================== Test Cases: Agregar ====================
        private void AddTestCaseButton_Click(object sender, RoutedEventArgs e)
        {
            string input = TestInputTextBox.Text.Trim();
            string output = TestOutputTextBox.Text.Trim();

            if (string.IsNullOrWhiteSpace(input) || string.IsNullOrWhiteSpace(output))
            {
                Log("‚ö†Ô∏è ADVERTENCIA: Input y Output no pueden estar vac√≠os.");
                return;
            }

            _currentTestCases.Add(new TestCaseDto
            {
                input = input,
                expected_output = output
            });

            RefreshTestCasesList();

            // Limpiar los TextBox
            TestInputTextBox.Clear();
            TestOutputTextBox.Clear();

            Log($"‚úÖ Caso de prueba agregado: '{input}' ‚Üí '{output}'");
        }

        // ==================== Test Cases: Eliminar ====================
        private void RemoveTestCaseButton_Click(object sender, RoutedEventArgs e)
        {
            if (TestCasesListBox.SelectedItem is not string selectedItem)
            {
                Log("‚ö†Ô∏è ADVERTENCIA: Selecciona un caso de prueba primero.");
                return;
            }

            int index = TestCasesListBox.SelectedIndex;
            if (index >= 0 && index < _currentTestCases.Count)
            {
                _currentTestCases.RemoveAt(index);
                RefreshTestCasesList();
                Log($"‚úÖ Caso de prueba eliminado.");
            }
        }

        // ==================== Refrescar lista visual de test cases ====================
        private void RefreshTestCasesList()
        {
            var displayList = _currentTestCases
                .Select(tc => $"{tc.input} ‚Üí {tc.expected_output}")
                .ToList();

            TestCasesListBox.ItemsSource = displayList;
        }

        // ==================== Limpiar formulario ====================
        private void ClearForm()
        {
            _selectedProblem = null;
            FormTitle.Text = "üìù Nuevo Problema";

            ProblemIdTextBox.Clear();
            ProblemIdTextBox.IsEnabled = true; // Habilitado para nuevos problemas

            TitleTextBox.Clear();
            DescriptionTextBox.Clear();
            CodeStubTextBox.Clear();
            TagsTextBox.Clear();

            DifficultyComboBox.SelectedIndex = 0; // F√°cil por defecto

            _currentTestCases.Clear();
            RefreshTestCasesList();

            TestInputTextBox.Clear();
            TestOutputTextBox.Clear();

            ProblemListBox.SelectedItem = null;
        }

        // ==================== Helper: Log a consola ====================
        private void Log(string message)
        {
            ConsoleTextBox.AppendText($"{DateTime.Now:HH:mm:ss} | {message}\n");
            ConsoleTextBox.ScrollToEnd();
        }
    }
}

--------------------------------------------------

UI\ApiClient.cs:
----------------
Ôªø

using System.Net.Http;
using System.Text;
using System.Text.Json;
namespace UI
{
    class ApiClient
    {
        private readonly HttpClient http = new HttpClient();

        public string MotorEvaluacionURL { get; set; }
        public string GestorProblemasURL { get; set; }
        public string AnalizadorURL { get; set; }

        public async Task<JsonDocument> GetProbelemList()
        {
            var response = await http.GetStreamAsync($"{GestorProblemasURL}/problems"); //Esto se cambia por la URL real
            return JsonDocument.Parse(response);
        }

        public async Task<JsonDocument> GetProblemDetail()
        {
            var response = await http.GetStreamAsync($"{GestorProblemasURL}/problem/detail"); //Esto se cambia por la URL real
            return JsonDocument.Parse(response);
        }

        public async Task<JsonDocument> RunSolution(string problemId, string code)
        {
            var body = JsonSerializer.Serialize(new
            {
                problemId,
                code,
                mode = "sample"
            });
            var response = await http.PostAsync(
                $"{MotorEvaluacionURL}/run",
                new StringContent(body, System.Text.Encoding.UTF8, "application/json"));
            return JsonDocument.Parse(await response.Content.ReadAsStringAsync());
        }

        public async Task<JsonDocument> SubmitSolution(string problemId, string code, string lang)
        {
            var body = JsonSerializer.Serialize(new
            {
                problemId,
                code,
                language = lang
            });

            var response = await http.PostAsync(
                $"{AnalizadorURL}/submit",
                new StringContent(body, Encoding.UTF8, "application/json"));

            return JsonDocument.Parse(await response.Content.ReadAsStringAsync());
        }



    }
}




--------------------------------------------------

UI\App.xaml:
------------
Ôªø<Application x:Class="UI.App"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:local="clr-namespace:UI"
             StartupUri="MainWindow.xaml">
    <Application.Resources>
         
    </Application.Resources>
</Application>


--------------------------------------------------

UI\App.xaml.cs:
---------------
Ôªøusing System.Configuration;
using System.Data;
using System.Windows;

namespace UI
{
    /// <summary>
    /// Interaction logic for App.xaml
    /// </summary>
    public partial class App : Application
    {
    }

}


--------------------------------------------------

UI\AssemblyInfo.cs:
-------------------
using System.Windows;

[assembly: ThemeInfo(
    ResourceDictionaryLocation.None,            //where theme specific resource dictionaries are located
                                                //(used if a resource is not found in the page,
                                                // or application resource dictionaries)
    ResourceDictionaryLocation.SourceAssembly   //where the generic resource dictionary is located
                                                //(used if a resource is not found in the page,
                                                // app, or any theme specific resource dictionaries)
)]


--------------------------------------------------

UI\MainWindow.xaml:
-------------------
Ôªø<Window x:Class="UI.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:avalonedit="http://icsharpcode.net/sharpdevelop/avalonedit"
        Title="CodeCoach" Width="1400" Height="900"
        Background="#1e1e1e">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Barra superior con bot√≥n de Modo Administrador -->
        <Border Grid.Row="0" Background="#2d2d30" Padding="10,5">
            <DockPanel>
                <TextBlock Text="CodeCoach"
                           VerticalAlignment="Center"
                           Foreground="White"
                           FontWeight="Bold"
                           FontSize="16"
                           DockPanel.Dock="Left" />

                <Button x:Name="AdminButton"
                        Content="‚öôÔ∏è Modo Administrador"
                        Click="AdminButton_Click"
                        Padding="10,6"
                        Background="#0e639c"
                        Foreground="White"
                        BorderThickness="0"
                        HorizontalAlignment="Right"
                        Cursor="Hand"
                        DockPanel.Dock="Right"/>
            </DockPanel>
        </Border>

        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="280"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <!-- PANEL IZQUIERDO: Filtros + Lista -->
            <Grid Grid.Column="0" Background="#252526">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <!-- FILTROS -->
                <Border Grid.Row="0" Background="#2d2d30" Padding="10" Margin="0,0,0,5">
                    <StackPanel>
                        <TextBlock Text="üîç Filtros" Foreground="White" FontWeight="Bold" FontSize="14" Margin="0,0,0,10"/>

                        <!-- Filtro por Dificultad -->
                        <TextBlock Text="Dificultad:" Foreground="White" Margin="0,0,0,3"/>
                        <ComboBox x:Name="DifficultyComboBox"
                                  Background="#1e1e1e"
                                  Foreground="White"
                                  Margin="0,0,0,10"
                                  SelectionChanged="DifficultyComboBox_SelectionChanged">
                            <ComboBoxItem Content="Todas" IsSelected="True"/>
                            <ComboBoxItem Content="Facil"/>
                            <ComboBoxItem Content="Medio"/>
                            <ComboBoxItem Content="Dificil"/>
                        </ComboBox>

                        <!-- Filtro por Tag -->
                        <TextBlock Text="Tag:" Foreground="White" Margin="0,0,0,3"/>
                        <TextBox x:Name="TagTextBox"
                                 Background="#1e1e1e"
                                 Foreground="White"
                                 Margin="0,0,0,5"
                                 ToolTip="Escribe un tag y presiona Enter"/>

                        <Button x:Name="FilterByTagButton"
                                Content="Filtrar por Tag"
                                Click="FilterByTagButton_Click"
                                Background="#0e639c"
                                Foreground="White"
                                BorderThickness="0"
                                Padding="6,4"
                                Cursor="Hand"
                                Margin="0,0,0,10"/>

                        <!-- Bot√≥n Problema Aleatorio -->
                        <Button x:Name="RandomProblemButton"
                                Content="üé≤ Problema Aleatorio"
                                Click="RandomProblemButton_Click"
                                Background="#008000"
                                Foreground="White"
                                BorderThickness="0"
                                Padding="6,4"
                                Cursor="Hand"
                                Margin="0,0,0,10"/>

                        <!-- Bot√≥n Resetear -->
                        <Button x:Name="ResetFiltersButton"
                                Content="üîÑ Mostrar Todos"
                                Click="ResetFiltersButton_Click"
                                Background="#555555"
                                Foreground="White"
                                BorderThickness="0"
                                Padding="6,4"
                                Cursor="Hand"/>
                    </StackPanel>
                </Border>

                <!-- LISTA DE PROBLEMAS -->
                <ListBox x:Name="ProblemList"
                         Grid.Row="1"
                         Background="#252526"
                         Foreground="White"
                         BorderThickness="0"
                         SelectionChanged="ProblemList_SelectionChanged" />
            </Grid>

            <!-- PANEL DERECHO: Descripci√≥n + Editor -->
            <Grid Grid.Column="1">
                <Grid.RowDefinitions>
                    <RowDefinition Height="3*"/>
                    <RowDefinition Height="2*"/>
                </Grid.RowDefinitions>

                <TabControl Grid.Row="0"
                            Background="#2d2d30"
                            Foreground="White">
                    <TabItem Header="Descripci√≥n">
                        <ScrollViewer>
                            <TextBlock x:Name="DescriptionText"
                                       TextWrapping="Wrap"
                                       Foreground="White"
                                       Margin="10"/>
                        </ScrollViewer>
                    </TabItem>
                </TabControl>

                <Grid Grid.Row="1">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="2*"/>
                    </Grid.RowDefinitions>

                    <StackPanel Orientation="Horizontal"
                                Grid.Row="0"
                                Margin="5">
                        <Button Content="Run"
                                Click="Run_Click"
                                Margin="0,0,8,0"/>
                        <Button Content="Submit"
                                Click="Submit_Click"/>
                    </StackPanel>

                    <avalonedit:TextEditor x:Name="CodeEditor"
                                           Grid.Row="1"
                                           FontFamily="Consolas"
                                           FontSize="14"
                                           SyntaxHighlighting="C++"
                                           Background="#1e1e1e"
                                           Foreground="White"
                                           ShowLineNumbers="True"/>

                    <TabControl Grid.Row="2"
                                Background="#2d2d30"
                                Foreground="White">
                        <TabItem Header="Console">
                            <TextBox x:Name="ConsoleOutput"
                                     Foreground="White"
                                     Background="#1e1e1e"
                                     TextWrapping="Wrap"
                                     AcceptsReturn="False"
                                     IsReadOnly="True"
                                     VerticalScrollBarVisibility="Auto"/>
                        </TabItem>
                        <TabItem Header="Output">
                            <TextBox x:Name="ResultOutput"
                                     Foreground="White"
                                     Background="#1e1e1e"
                                     IsReadOnly="True"
                                     VerticalScrollBarVisibility="Auto"/>
                        </TabItem>
                    </TabControl>
                </Grid>
            </Grid>
        </Grid>
    </Grid>
</Window>

--------------------------------------------------

UI\MainWindow.xaml.cs:
----------------------
Ôªøusing System;
using System.Linq;
using System.Windows;
using System.Windows.Controls;
using UI.Models;
using UI.Services;

namespace UI
{
    public partial class MainWindow : Window
    {
        private ProblemApiClient _apiClient;
        private ProblemDto? _currentProblem;
        private bool _isLoadingProblems = false;

        public MainWindow()
        {
            InitializeComponent();
            _apiClient = new ProblemApiClient("http://localhost:8080");
            Loaded += MainWindow_Loaded;
        }

        // ==================== Evento: Ventana cargada ====================
        private async void MainWindow_Loaded(object sender, RoutedEventArgs e)
        {
            await LoadProblemListAsync();
        }

        // ==================== Cargar lista de problemas ====================
        private async System.Threading.Tasks.Task LoadProblemListAsync()
        {
            if (_isLoadingProblems) return;

            try
            {
                _isLoadingProblems = true;
                DisableButtons();

                ConsoleOutput.Text = "üîÑ Conectando al Gestor de Problemas...\n";

                bool isHealthy = await _apiClient.IsHealthyAsync();
                if (!isHealthy)
                {
                    ConsoleOutput.Text += "‚ùå ERROR: No se puede conectar al servidor en http://localhost:8080\n";
                    ConsoleOutput.Text += "   ‚Üí Aseg√∫rate de que 'problem_manager_api.exe' est√© corriendo.\n";
                    ConsoleOutput.Text += "   ‚Üí Verifica que MongoDB est√© activo.\n";
                    return;
                }

                ConsoleOutput.Text += "‚úÖ Conexi√≥n exitosa al servidor.\n";

                var problems = await _apiClient.GetAllProblemsAsync();

                if (problems.Count == 0)
                {
                    ConsoleOutput.Text += "\nüì≠ No hay problemas en la base de datos.\n";
                    ConsoleOutput.Text += "   ‚Üí Puedes crear algunos usando el Modo Administrador.\n";
                    ProblemList.ItemsSource = null;
                    return;
                }

                ProblemList.ItemsSource = problems;
                ProblemList.DisplayMemberPath = "title";

                ConsoleOutput.Text += $"‚úÖ {problems.Count} problema(s) cargado(s) correctamente.\n\n";
                ConsoleOutput.Text += "üí° Selecciona un problema de la lista para ver sus detalles.\n";
            }
            catch (Exception ex)
            {
                ConsoleOutput.Text += $"‚ùå ERROR: {ex.Message}\n";
            }
            finally
            {
                _isLoadingProblems = false;
                EnableButtons();
            }
        }

        // ==================== Filtro por Dificultad ====================
        private async void DifficultyComboBox_SelectionChanged(object sender, SelectionChangedEventArgs e)
        {
            // Evitar ejecuci√≥n durante la inicializaci√≥n de la ventana
            if (!this.IsLoaded) return;
            if (DifficultyComboBox.SelectedItem == null) return;
            if (_isLoadingProblems) return;

            string selectedDifficulty = ((ComboBoxItem)DifficultyComboBox.SelectedItem).Content.ToString();

            if (selectedDifficulty == "Todas")
            {
                await LoadProblemListAsync();
                return;
            }

            try
            {
                _isLoadingProblems = true;
                DisableButtons();

                ConsoleOutput.Text = $"üîç Filtrando por dificultad: {selectedDifficulty}...\n";

                var problems = await _apiClient.GetProblemsByDifficultyAsync(selectedDifficulty);

                if (problems.Count == 0)
                {
                    ConsoleOutput.Text += $"üì≠ No hay problemas con dificultad '{selectedDifficulty}'.\n";
                    ProblemList.ItemsSource = null;
                    return;
                }

                ProblemList.ItemsSource = problems;
                ProblemList.DisplayMemberPath = "title";

                ConsoleOutput.Text += $"‚úÖ {problems.Count} problema(s) encontrado(s).\n";
            }
            catch (Exception ex)
            {
                ConsoleOutput.Text += $"‚ùå ERROR al filtrar: {ex.Message}\n";
            }
            finally
            {
                _isLoadingProblems = false;
                EnableButtons();
            }
        }

        // ==================== Filtro por Tag ====================
        private async void FilterByTagButton_Click(object sender, RoutedEventArgs e)
        {
            string tag = TagTextBox.Text.Trim();

            if (string.IsNullOrEmpty(tag))
            {
                MessageBox.Show("Por favor escribe un tag para filtrar.", "Campo vac√≠o", MessageBoxButton.OK, MessageBoxImage.Warning);
                return;
            }

            try
            {
                _isLoadingProblems = true;
                DisableButtons();

                ConsoleOutput.Text = $"üîç Filtrando por tag: '{tag}'...\n";

                var problems = await _apiClient.GetProblemsByTagAsync(tag);

                if (problems.Count == 0)
                {
                    ConsoleOutput.Text += $"üì≠ No hay problemas con el tag '{tag}'.\n";
                    ProblemList.ItemsSource = null;
                    return;
                }

                ProblemList.ItemsSource = problems;
                ProblemList.DisplayMemberPath = "title";

                ConsoleOutput.Text += $"‚úÖ {problems.Count} problema(s) encontrado(s).\n";
            }
            catch (Exception ex)
            {
                ConsoleOutput.Text += $"‚ùå ERROR al filtrar: {ex.Message}\n";
            }
            finally
            {
                _isLoadingProblems = false;
                EnableButtons();
            }
        }

        // ==================== Problema Aleatorio ====================
        private async void RandomProblemButton_Click(object sender, RoutedEventArgs e)
        {
            try
            {
                _isLoadingProblems = true;
                DisableButtons();

                ConsoleOutput.Text = "üé≤ Obteniendo problema aleatorio...\n";

                var problem = await _apiClient.GetRandomProblemAsync();

                if (problem == null)
                {
                    ConsoleOutput.Text += "üì≠ No hay problemas disponibles.\n";
                    return;
                }

                _currentProblem = problem;

                DescriptionText.Text = $"üìù {problem.title}\n\n" +
                                      $"üè∑Ô∏è  ID: {problem.problem_id}\n" +
                                      $"‚ö° Dificultad: {problem.difficulty}\n" +
                                      $"üè∑Ô∏è  Tags: {string.Join(", ", problem.tags)}\n\n" +
                                      $"üìÑ DESCRIPCI√ìN:\n{problem.description}\n\n" +
                                      $"üìå CASOS DE PRUEBA:\n{FormatTestCases(problem.test_cases)}";

                CodeEditor.Text = problem.code_stub ?? "// Escribe tu soluci√≥n aqu√≠\n";

                ConsoleOutput.Text += $"‚úÖ Problema cargado: {problem.title}\n";
            }
            catch (Exception ex)
            {
                ConsoleOutput.Text += $"‚ùå ERROR: {ex.Message}\n";
            }
            finally
            {
                _isLoadingProblems = false;
                EnableButtons();
            }
        }

        // ==================== Resetear Filtros ====================
        private async void ResetFiltersButton_Click(object sender, RoutedEventArgs e)
        {
            DifficultyComboBox.SelectedIndex = 0;
            TagTextBox.Text = "";
            await LoadProblemListAsync();
        }

        // ==================== Evento: Problema seleccionado ====================
        private async void ProblemList_SelectionChanged(object sender, SelectionChangedEventArgs e)
        {
            if (ProblemList.SelectedItem is not ProblemDto selectedProblem)
                return;

            try
            {
                ConsoleOutput.Text = $"üì• Cargando detalles de '{selectedProblem.title}'...\n";

                var fullProblem = await _apiClient.GetProblemAsync(selectedProblem.problem_id);

                if (fullProblem == null)
                {
                    ConsoleOutput.Text += "‚ùå ERROR: No se pudo cargar el problema completo.\n";
                    return;
                }

                _currentProblem = fullProblem;

                DescriptionText.Text = $"üìù {fullProblem.title}\n\n" +
                                      $"üè∑Ô∏è  ID: {fullProblem.problem_id}\n" +
                                      $"‚ö° Dificultad: {fullProblem.difficulty}\n" +
                                      $"üè∑Ô∏è  Tags: {string.Join(", ", fullProblem.tags)}\n\n" +
                                      $"üìÑ DESCRIPCI√ìN:\n{fullProblem.description}\n\n" +
                                      $"üìå CASOS DE PRUEBA:\n{FormatTestCases(fullProblem.test_cases)}";

                CodeEditor.Text = fullProblem.code_stub ?? "// Escribe tu soluci√≥n aqu√≠\n";

                ConsoleOutput.Text += "‚úÖ Problema cargado correctamente.\n";
            }
            catch (Exception ex)
            {
                ConsoleOutput.Text += $"‚ùå ERROR: {ex.Message}\n";
            }
        }

        // ==================== Formatear casos de prueba ====================
        private string FormatTestCases(System.Collections.Generic.List<TestCaseDto> testCases)
        {
            if (testCases == null || testCases.Count == 0)
                return "  (No hay casos de prueba definidos)\n";

            var result = "";
            for (int i = 0; i < testCases.Count; i++)
            {
                result += $"  Test {i + 1}:\n";
                result += $"    Input: {testCases[i].input}\n";
                result += $"    Expected: {testCases[i].expected_output}\n\n";
            }
            return result;
        }

        // ==================== Bot√≥n Run ====================
        private void Run_Click(object sender, RoutedEventArgs e)
        {
            ConsoleOutput.Text = "‚öôÔ∏è La funci√≥n 'Run' a√∫n no est√° implementada.\n";
            ConsoleOutput.Text += "   ‚Üí Esta funci√≥n se conectar√° al Motor de Evaluaci√≥n.\n";
        }

        // ==================== Bot√≥n Submit ====================
        private void Submit_Click(object sender, RoutedEventArgs e)
        {
            ConsoleOutput.Text = "‚öôÔ∏è La funci√≥n 'Submit' a√∫n no est√° implementada.\n";
            ConsoleOutput.Text += "   ‚Üí Esta funci√≥n enviar√° la soluci√≥n al Motor de Evaluaci√≥n.\n";
        }

        // ==================== Bot√≥n Admin ====================
        private void AdminButton_Click(object sender, RoutedEventArgs e)
        {
            var adminWindow = new AdminWindow();
            adminWindow.Show();
        }

        // ==================== Helpers: Deshabilitar/Habilitar botones ====================
        private void DisableButtons()
        {
            if (FilterByTagButton != null) FilterByTagButton.IsEnabled = false;
            if (RandomProblemButton != null) RandomProblemButton.IsEnabled = false;
            if (ResetFiltersButton != null) ResetFiltersButton.IsEnabled = false;
            if (DifficultyComboBox != null) DifficultyComboBox.IsEnabled = false;
        }

        private void EnableButtons()
        {
            if (FilterByTagButton != null) FilterByTagButton.IsEnabled = true;
            if (RandomProblemButton != null) RandomProblemButton.IsEnabled = true;
            if (ResetFiltersButton != null) ResetFiltersButton.IsEnabled = true;
            if (DifficultyComboBox != null) DifficultyComboBox.IsEnabled = true;
        }
    }
}

--------------------------------------------------

UI\Models\ProblemDto.cs:
------------------------
Ôªø// Archivo: Models/ProblemDto.cs
// Modelos que representan el JSON que env√≠a/recibe el Gestor de Problemas (C++).

using System.Collections.Generic;

namespace UI.Models
{
    /// <summary>
    /// Representa un caso de prueba de un problema.
    /// Coincide exactamente con el JSON del Gestor.
    /// </summary>
    public class TestCaseDto
    {
        public string input { get; set; } = string.Empty;
        public string expected_output { get; set; } = string.Empty;
    }

    /// <summary>
    /// Representa un problema completo de CodeCoach.
    /// Los nombres de las propiedades coinciden con el JSON.
    /// </summary>
    public class ProblemDto
    {
        public string problem_id { get; set; } = string.Empty;
        public string title { get; set; } = string.Empty;
        public string description { get; set; } = string.Empty;
        public string difficulty { get; set; } = string.Empty;
        public List<string> tags { get; set; } = new();
        public List<TestCaseDto> test_cases { get; set; } = new();
        public string code_stub { get; set; } = string.Empty;
    }

    /// <summary>
    /// Respuesta del Gestor para GET /problems.
    /// </summary>
    public class ProblemListResponse
    {
        public List<ProblemDto> problems { get; set; } = new();
    }

    /// <summary>
    /// Respuesta gen√©rica del Gestor para POST/PUT/DELETE.
    /// </summary>
    public class ApiResponse
    {
        public string message { get; set; } = string.Empty;
        public string? problem_id { get; set; }
    }

    /// <summary>
    /// Respuesta de error del Gestor.
    /// </summary>
    public class ErrorResponse
    {
        public string error { get; set; } = string.Empty;
    }
}


--------------------------------------------------

UI\Services\ProblemApiClient.cs:
--------------------------------
Ôªø// Archivo: Services/ProblemApiClient.cs
// Cliente HTTP para hablar con el Gestor de Problemas en C++ (Crow + MongoDB).

using System;
using System.Collections.Generic;
using System.Net.Http;
using System.Net.Http.Json;
using System.Text;
using System.Text.Json;
using System.Threading.Tasks;
using UI.Models;

namespace UI.Services
{
    /// <summary>
    /// Cliente HTTP para comunicarse con el Gestor de Problemas (REST API en C++).
    /// Maneja las operaciones CRUD de problemas.
    /// </summary>
    public class ProblemApiClient
    {
        private readonly HttpClient _httpClient;

        /// <param name="gestorBaseUrl">URL base del Gestor, ej: "http://localhost:8080"</param>
        public ProblemApiClient(string gestorBaseUrl = "http://localhost:8080")
        {
            // Aseguramos que no haya doble slash en las rutas
            gestorBaseUrl = gestorBaseUrl.TrimEnd('/');

            _httpClient = new HttpClient
            {
                BaseAddress = new Uri(gestorBaseUrl),
                Timeout = TimeSpan.FromSeconds(30)
            };
        }

        // ==================== GET /health ====================
        public async Task<bool> IsHealthyAsync()
        {
            try
            {
                var response = await _httpClient.GetAsync("/health");
                return response.IsSuccessStatusCode;
            }
            catch
            {
                return false;
            }
        }

        // ==================== GET /problems ====================
        /// <summary>
        /// Obtiene la lista resumida de todos los problemas.
        /// </summary>
        public async Task<List<ProblemDto>> GetAllProblemsAsync()
        {
            try
            {
                var response = await _httpClient.GetAsync("/problems");

                if (!response.IsSuccessStatusCode)
                {
                    Console.WriteLine($"[ERROR] GET /problems fall√≥: {response.StatusCode}");
                    return new List<ProblemDto>();
                }

                var result = await response.Content.ReadFromJsonAsync<ProblemListResponse>();
                return result?.problems ?? new List<ProblemDto>();
            }
            catch (Exception ex)
            {
                Console.WriteLine($"[ERROR] Excepci√≥n en GetAllProblemsAsync: {ex.Message}");
                return new List<ProblemDto>();
            }
        }

        // ==================== GET /problems/{id} ====================
        /// <summary>
        /// Obtiene el detalle completo de un problema.
        /// </summary>
        public async Task<ProblemDto?> GetProblemAsync(string problemId)
        {
            try
            {
                var response = await _httpClient.GetAsync($"/problems/{problemId}");

                if (response.StatusCode == System.Net.HttpStatusCode.NotFound)
                {
                    Console.WriteLine($"[INFO] Problema '{problemId}' no encontrado (404).");
                    return null;
                }

                if (!response.IsSuccessStatusCode)
                {
                    Console.WriteLine($"[ERROR] GET /problems/{problemId} fall√≥: {response.StatusCode}");
                    return null;
                }

                return await response.Content.ReadFromJsonAsync<ProblemDto>();
            }
            catch (Exception ex)
            {
                Console.WriteLine($"[ERROR] Excepci√≥n en GetProblemAsync: {ex.Message}");
                return null;
            }
        }

        // ==================== POST /problems ====================
        /// <summary>
        /// Crea un nuevo problema. El DTO DEBE incluir un problem_id √∫nico.
        /// </summary>
        public async Task<bool> CreateProblemAsync(ProblemDto problem)
        {
            try
            {
                var json = JsonSerializer.Serialize(problem);
                var content = new StringContent(json, Encoding.UTF8, "application/json");

                var response = await _httpClient.PostAsync("/problems", content);

                if (!response.IsSuccessStatusCode)
                {
                    var error = await response.Content.ReadAsStringAsync();
                    Console.WriteLine($"[ERROR] POST /problems fall√≥ ({response.StatusCode}): {error}");
                    return false;
                }

                var result = await response.Content.ReadFromJsonAsync<ApiResponse>();
                Console.WriteLine($"[OK] Problema '{result?.problem_id}' creado: {result?.message}");
                return true;
            }
            catch (Exception ex)
            {
                Console.WriteLine($"[ERROR] Excepci√≥n en CreateProblemAsync: {ex.Message}");
                return false;
            }
        }

        // ==================== PUT /problems/{id} ====================
        /// <summary>
        /// Actualiza un problema existente. El ID va en la URL, NO en el body.
        /// </summary>
        public async Task<bool> UpdateProblemAsync(string problemId, ProblemDto problemWithoutId)
        {
            try
            {
                // Creamos una copia sin problem_id, porque el Gestor lo toma de la URL
                var bodyObject = new
                {
                    title = problemWithoutId.title,
                    description = problemWithoutId.description,
                    difficulty = problemWithoutId.difficulty,
                    code_stub = problemWithoutId.code_stub,
                    tags = problemWithoutId.tags,
                    test_cases = problemWithoutId.test_cases
                };

                var json = JsonSerializer.Serialize(bodyObject);
                var content = new StringContent(json, Encoding.UTF8, "application/json");

                var response = await _httpClient.PutAsync($"/problems/{problemId}", content);

                if (response.StatusCode == System.Net.HttpStatusCode.NotFound)
                {
                    Console.WriteLine($"[ERROR] PUT /problems/{problemId} (404 No encontrado).");
                    return false;
                }

                if (!response.IsSuccessStatusCode)
                {
                    var error = await response.Content.ReadAsStringAsync();
                    Console.WriteLine($"[ERROR] PUT /problems/{problemId} fall√≥ ({response.StatusCode}): {error}");
                    return false;
                }

                var result = await response.Content.ReadFromJsonAsync<ApiResponse>();
                Console.WriteLine($"[OK] Problema '{result?.problem_id}' actualizado: {result?.message}");
                return true;
            }
            catch (Exception ex)
            {
                Console.WriteLine($"[ERROR] Excepci√≥n en UpdateProblemAsync: {ex.Message}");
                return false;
            }
        }

        // ==================== DELETE /problems/{id} ====================
        /// <summary>
        /// Elimina un problema existente.
        /// </summary>
        public async Task<bool> DeleteProblemAsync(string problemId)
        {
            try
            {
                var response = await _httpClient.DeleteAsync($"/problems/{problemId}");

                if (response.StatusCode == System.Net.HttpStatusCode.NotFound)
                {
                    Console.WriteLine($"[ERROR] DELETE /problems/{problemId} (404 No encontrado).");
                    return false;
                }

                if (!response.IsSuccessStatusCode)
                {
                    var error = await response.Content.ReadAsStringAsync();
                    Console.WriteLine($"[ERROR] DELETE /problems/{problemId} fall√≥ ({response.StatusCode}): {error}");
                    return false;
                }

                var result = await response.Content.ReadFromJsonAsync<ApiResponse>();
                Console.WriteLine($"[OK] Problema '{result?.problem_id}' eliminado: {result?.message}");
                return true;
            }
            catch (Exception ex)
            {
                Console.WriteLine($"[ERROR] Excepci√≥n en DeleteProblemAsync: {ex.Message}");
                return false;
            }
        }

        // ==================== Extras opcionales ====================

        public async Task<List<ProblemDto>> GetProblemsByDifficultyAsync(string difficulty)
        {
            try
            {
                var response = await _httpClient.GetAsync($"/problems/difficulty/{difficulty}");
                if (!response.IsSuccessStatusCode)
                    return new List<ProblemDto>();

                var result = await response.Content.ReadFromJsonAsync<ProblemListResponse>();
                return result?.problems ?? new List<ProblemDto>();
            }
            catch
            {
                return new List<ProblemDto>();
            }
        }

        public async Task<List<ProblemDto>> GetProblemsByTagAsync(string tag)
        {
            try
            {
                var response = await _httpClient.GetAsync($"/problems/tags/{tag}");
                if (!response.IsSuccessStatusCode)
                    return new List<ProblemDto>();

                var result = await response.Content.ReadFromJsonAsync<ProblemListResponse>();
                return result?.problems ?? new List<ProblemDto>();
            }
            catch
            {
                return new List<ProblemDto>();
            }
        }

        public async Task<ProblemDto?> GetRandomProblemAsync()
        {
            try
            {
                var response = await _httpClient.GetAsync("/problems/random");
                if (!response.IsSuccessStatusCode)
                    return null;

                return await response.Content.ReadFromJsonAsync<ProblemDto>();
            }
            catch
            {
                return null;
            }
        }


    }
}


--------------------------------------------------

UI\UI.csproj:
-------------
Ôªø<Project Sdk="Microsoft.NET.Sdk">

  <PropertyGroup>
    <OutputType>WinExe</OutputType>
    <TargetFramework>net8.0-windows</TargetFramework>
    <Nullable>enable</Nullable>
    <ImplicitUsings>enable</ImplicitUsings>
    <UseWPF>true</UseWPF>
  </PropertyGroup>

  <ItemGroup>
    <PackageReference Include="AvalonEdit" Version="6.3.1.120" />
  </ItemGroup>

</Project>


--------------------------------------------------

UI\UI.sln:
----------
Ôªø
Microsoft Visual Studio Solution File, Format Version 12.00
# Visual Studio Version 17
VisualStudioVersion = 17.14.36705.20 d17.14
MinimumVisualStudioVersion = 10.0.40219.1
Project("{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}") = "UI", "UI.csproj", "{1EDBFFF0-91AB-4162-B93F-2EE889278C68}"
EndProject
Global
	GlobalSection(SolutionConfigurationPlatforms) = preSolution
		Debug|Any CPU = Debug|Any CPU
		Release|Any CPU = Release|Any CPU
	EndGlobalSection
	GlobalSection(ProjectConfigurationPlatforms) = postSolution
		{1EDBFFF0-91AB-4162-B93F-2EE889278C68}.Debug|Any CPU.ActiveCfg = Debug|Any CPU
		{1EDBFFF0-91AB-4162-B93F-2EE889278C68}.Debug|Any CPU.Build.0 = Debug|Any CPU
		{1EDBFFF0-91AB-4162-B93F-2EE889278C68}.Release|Any CPU.ActiveCfg = Release|Any CPU
		{1EDBFFF0-91AB-4162-B93F-2EE889278C68}.Release|Any CPU.Build.0 = Release|Any CPU
	EndGlobalSection
	GlobalSection(SolutionProperties) = preSolution
		HideSolutionNode = FALSE
	EndGlobalSection
	GlobalSection(ExtensibilityGlobals) = postSolution
		SolutionGuid = {2D255AFF-E9BC-43BB-96E1-3947C6BB15D5}
	EndGlobalSection
EndGlobal


--------------------------------------------------

main.cpp:
---------
#include <bsoncxx/json.hpp>
#include <bsoncxx/builder/basic/document.hpp>
#include <bsoncxx/builder/basic/array.hpp>
#include <mongocxx/client.hpp>
#include <mongocxx/instance.hpp>
#include <mongocxx/uri.hpp>
#include <iostream>






int main() {
    mongocxx::instance inst{};
    mongocxx::client client{mongocxx::uri{"mongodb://localhost:27017"}};

    auto db = client["codecoach"];
    auto collection = db["problems"];

    using bsoncxx::builder::basic::kvp;
    using bsoncxx::builder::basic::make_document;
    using bsoncxx::builder::basic::make_array;

    auto doc = make_document(
        kvp("title", "Suma de tres   n√∫meros"),
        kvp("difficulty", "F√°cil"),
        kvp("tags", make_array("math", "intro")),
        kvp("test_cases", make_array(
            make_document(
                kvp("input", "2 3"),
                kvp("output", "5")
            )
        ))
    );
    auto result = collection.insert_one(doc.view());
    std::cout << "Documento insertado con ID: "
              << result->inserted_id().get_oid().value.to_string() << std::endl;

    auto cursor = collection.find({});
    std::cout << "\nüì¶ Documentos en 'problems':\n";
    for (auto&& item : cursor) {
        std::cout << bsoncxx::to_json(item) << std::endl;
    }

    return 0;
}



--------------------------------------------------

